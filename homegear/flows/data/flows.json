[{"disabled":false,"id":"af5f5744.c39ba","info":"","label":"MySmarthomeAdmin","namespace":"tab","type":"tab"},{"broker":"localhost","clientid":"","id":"9c814888.ebc608","namespace":"mqtt","port":"1883","type":"mqtt-broker","usetls":false,"z":""},{"broker":"9c814888.ebc608","id":"f0855ab9.825048","loopprevention":false,"looppreventiongroup":"","name":"SetHeatingWeekProfile","namespace":"mqtt","topic":"cmdhomegear/SetHeatingWeekProfile","type":"mqtt-in","wires":[[{"id":"d37cc093.2c0d","port":0},{"id":"5ef4c904.2ade78","port":0}]],"x":240,"y":250,"z":"af5f5744.c39ba"},{"active":true,"complete":"true","console":"debtab","id":"d37cc093.2c0d","loglevel":"info","name":"","namespace":"debug","type":"debug","wires":[],"x":1110,"y":330,"z":"af5f5744.c39ba"},{"broker":"9c814888.ebc608","id":"4b1d2fc7.96b23","loopprevention":false,"looppreventiongroup":"","name":"RetrieveHeatingWeekProfile","namespace":"mqtt","topic":"cmdhomegear/RetrieveHeatingWeekProfile","type":"mqtt-in","wires":[[{"id":"643dfa2a.586b44","port":0}]],"x":265,"y":110,"z":"af5f5744.c39ba"},{"func":"$payload = $message['payload'];\n$room = $payload['room'];\n$hg->log(4, \"Get week profile for room \" . $room);\n$peerId;\nif (strcasecmp($room, \"livingroom\") == 0) {\n    $peerId = 5; \n} elseif (strcasecmp($room, \"bathroom\") == 0) {\n    $peerId = 8; \n} elseif (strcasecmp($room, \"kitchen\") == 0) {\n    $peerId = 10; \n} elseif (strcasecmp($room, \"office\") == 0) {\n    $peerId = 1; \n} elseif (strcasecmp($room, \"bedroom\") == 0) {\n    $peerId = 11; \n} \n$profile;\n$hg->log(4, \"Get week profile for peerId \" . $peerId);\nif (isset($peerId)) {\n    $profile = $hg->getParamset($peerId, 0);\n    $hg->log(4, \"Data:\\n\" . print_r($profile, TRUE)); \n}\n$result['data'] = $profile;\n$result['room'] = $room;\n$message['payload'] = $result;\nreturn $message;","id":"c5cbd9f5.28fac8","inputs":1,"name":"GetHeatingWeekProfile","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"42e7ef4d.eeef6","port":0},{"id":"d37cc093.2c0d","port":0}]],"x":725,"y":50,"z":"af5f5744.c39ba"},{"id":"643dfa2a.586b44","name":"","namespace":"parsers","type":"json","wires":[[{"id":"c5cbd9f5.28fac8","port":0},{"id":"d37cc093.2c0d","port":0}]],"x":430,"y":40,"z":"af5f5744.c39ba"},{"id":"42e7ef4d.eeef6","name":"","namespace":"parsers","type":"json","wires":[[{"id":"d37cc093.2c0d","port":0},{"id":"359cd4a4.e636ec","port":0}]],"x":980,"y":60,"z":"af5f5744.c39ba"},{"broker":"9c814888.ebc608","id":"359cd4a4.e636ec","name":"","namespace":"mqtt","retain":"","topic":"msghomegear/GetHeatingWeekProfile","type":"mqtt-out","wires":[],"x":1270,"y":70,"z":"af5f5744.c39ba"},{"id":"5ef4c904.2ade78","name":"","namespace":"parsers","type":"json","wires":[[{"id":"bb2693fe.e1642","port":0},{"id":"d37cc093.2c0d","port":0}]],"x":440,"y":350,"z":"af5f5744.c39ba"},{"func":"$payload = $message['payload'];\n$room = $payload['room'];\n$data = $payload['data'];\n$hg->log(3, \"Set week profile for room \" . $room);\n$hg->log(4, \"Data:\\n\" . print_r($data, TRUE)); \n$peerId;\nif (strcasecmp($room, \"livingroom\") == 0) {\n    $peerId = 5; \n} elseif (strcasecmp($room, \"bathroom\") == 0) {\n    $peerId = 8; \n} elseif (strcasecmp($room, \"kitchen\") == 0) {\n    $peerId = 10; \n} elseif (strcasecmp($room, \"office\") == 0) {\n    $peerId = 1; \n} elseif (strcasecmp($room, \"bedroom\") == 0) {\n    $peerId = 11; \n} \n$result;\n$hg->log(4, \"Set week profile for peerId \" . $peerId);\nif (isset($peerId)) {\n    $hg->log(4, \"Set it now\");\n    $result = $hg->putParamset($peerId, 0, $data);\n}\n$hg->log(4, \"Result=\" . $result);\n$payload['result'] = $result;\n$message['payload'] = $payload;\nreturn $message;","id":"bb2693fe.e1642","inputs":1,"name":"PutHeatingWeekProfile","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[{"id":"1e7a581f.002cd8","port":0}]],"x":695,"y":370,"z":"af5f5744.c39ba"},{"id":"1e7a581f.002cd8","name":"","namespace":"parsers","type":"json","wires":[[{"id":"d37cc093.2c0d","port":0},{"id":"3002cdb.1bb7532","port":0}]],"x":900,"y":380,"z":"af5f5744.c39ba"},{"broker":"9c814888.ebc608","id":"3002cdb.1bb7532","name":"ResultSetHeatingWeekProfile","namespace":"mqtt","retain":"","topic":"msghomegear/GetHeatingWeekProfile","type":"mqtt-out","wires":[],"x":1320,"y":410,"z":"af5f5744.c39ba"},{"broker":"9c814888.ebc608","id":"7d09dc00.20aee4","loopprevention":false,"looppreventiongroup":"","name":"SetParty","namespace":"mqtt","topic":"cmdhomegear/SetParty","type":"mqtt-in","wires":[[{"id":"a8521103.579cc","port":0}]],"x":210,"y":500,"z":"af5f5744.c39ba"},{"id":"a8521103.579cc","name":"","namespace":"parsers","type":"json","wires":[[{"id":"5c97aab5.3510e4","port":0},{"id":"21a9acd3.7ee8d4","port":0}]],"x":400,"y":510,"z":"af5f5744.c39ba"},{"func":"include 'party.php';\n$payload = $message['payload'];\n$roomIds = $payload['roomIds'];\n$temperature = $payload['temperature'];\n$until = $payload['until'];\n$year = $until['year'];\n$month = $until['month'];\n$day = $until['day'];\n$hour = $until['hour'];\n$minute = $until['minute'];\nforeach ($roomIds as $roomId) {\n    setPartyValues($roomId, $year, $month, $day, $hour, $minute, $temperature);\n}\n$message['payload'] = true;\nreturn $message;","id":"5c97aab5.3510e4","inputs":1,"name":"SetPartyToDevice","namespace":"function","noerr":0,"outputs":1,"type":"function","wires":[[]],"x":630,"y":510,"z":"af5f5744.c39ba"},{"active":true,"complete":"true","console":"debtab","id":"21a9acd3.7ee8d4","loglevel":"info","name":"","namespace":"debug","type":"debug","wires":[],"x":790,"y":450,"z":"af5f5744.c39ba"}]